#include<bits/stdc++.h>
using namespace std;

const int MAX_R = 100005;
int N, M, R;
int x[MAX_R], y[MAX_R], d[MAX_R];

int main(){
    V = N+M;
    E=R;
    for(int i=0; i<R; i++){
        es[i]=(edge)(x[i], N+y[i], -d[i]);
    }
    cout << 10000*(N+M)+kruskal() << endl;
    return 0;
}